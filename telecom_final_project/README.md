# Прогнозирование оттока клиентов телеком компании (выпускной проект)
## Описание проекта 
Чтобы избежать потери клиентов, оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать их отток. 
Потенциально готовым уйти клиентам будут предложены скидки и бонусы. 
На основании данных о клиентах оператора необходимо построить модель, способную предсказать уход клиента. 

**Описание услуг**

Оператор предоставляет два основных типа услуг:

1.	Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.

2.	Интернет. Подключение может быть двух типов: через телефонную линию (DSL, от англ. digital subscriber line, «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic).

**Также доступны такие услуги:**

•	Интернет-безопасность: антивирус (DeviceProtection) и блокировка небезопасных сайтов (OnlineSecurity);

•	Выделенная линия технической поддержки (TechSupport);

•	Облачное хранилище файлов для резервного копирования данных (OnlineBackup);

•	Стриминговое телевидение (StreamingTV) и каталог фильмов (StreamingMovies).

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

## Описание данных 
Данные состоят из файлов, полученных из разных источников:

•	`contract.csv` — информация о договоре;

•	`personal.csv` — персональные данные клиента;

•	`internet.csv` — информация об интернет-услугах;

•	`phone.csv` — информация об услугах телефонии.

Во всех файлах столбец customerID содержит код клиента.

**Информация о договорах актуальна на 1 февраля 2020.**

## Отчет
Отток клиентов – это потеря клиентов в течение определенного периода времени. Такое явление очень болезненно переживается компаниями с подписной и транзакционной моделью бизнеса, так как поступление регулярных платежей в адрес компании при оттоке клиентов начинает снижаться. 

Качественное прогнозирование оттока клиентов поможет компании избежать финансовых потерь и повысить свою репутацию, зарекомендовав себя в качестве поставщика услуг, готового быть в контакте с потребителем. 

В рамках проекта была разработана модель, прогнозирующая отток клиентов для оператора связи «Ниединогоразрыва.ком». На основании прогноза оператор планирует предлагать потенциально уходящим клиентам бонусы и специальные условия. Прогноз был построен без привязки к предполагаемому времени ухода для того, чтобы обученную модель можно было использовать в дальнейшем, в том числе на обновленных данных. 

Качество прогноза отслеживается по показателям метрики ROC AUC. 

**Описание данных**

Для разработки модели прогнозирования заказчиком были предоставлены 4 датасета с информацией о клиентах и используемых услугах. На момент выгрузки данных из базы (1/02/2020) у компании было 7043 зарегистрированных клиента, почти четверть из которых расторгла договор с оператором. 

Таблицы содержали неодинаковое количество строк, так как некоторые клиенты не использовали указанные в таблицах сервисы. 

**Обработка данных**

В ходе работы с данными были изменены их типы, что позволило проводить все необходимые для исследования операции. 

Также было обнаружено 11 новых клиентов, которые на момент выгрузки данных не успели продемонстрировать потребительское поведение, так как заключили договор с компанией всего 1 месяц назад. Информация об этих клиентах был исключена из исследования.

В таблицу с данными о договорах было добавлено два дополнительных признака: факт ухода клиента и общий срок использования услуг (на момент выгрузки данных для оставшихся клиентов и на момент прекращения договора для ушедших клиентов). После этого таблицы были объединены в одну. Затем была проведена визуализация данных. 

**Выводы после визуализации**

- ежемесячные платежи ушедших клиентов были выше, чем у оставшихся;

- ушедшие клиенты пользовались услугами компании не так долго, как оставшиеся;

- помесячный тип оплаты в целом оказался самым популярным. В том числе среди ушедших клиентов;

- большая часть ушедших клиентов расплачивалась методом 'Electronic check'. Среди оставшихся клиентов все способы оплаты примерно одинаково популярны;

- обнаружена сильная корреляция между сроком использования услуг и суммой общих платежей. Данные об общих платежах в дальнейшем исключены из исследования;

- с точки зрения ухода клиента самый значительный коэффициент можно увидеть между уходом и использованием интернета. 
- Использование остальных услуг не оказывает значительного влияния на уход клиента. 
Возможно, соотношение цены и качества интернета не устроило ушедших клиентов. 
Пол, пенсионный статус, наличие партнера и иждивенцев не оказывают влияния на уход клиента.

**Обучение моделей** 

Перед обучением моделей из таблицы были удалены данные об общих платежах, датах начала и окончания использования услуг, а также данные о поле клиента.

Несмотря на существующий дисбаланс классов (оставшихся клиентов в три раза больше, чем ушедших), ни один из методов борьбы с дисбалансом не был применен, так как это не влияет на метрику ROC AUC. 

Данные были закодированы техникой One-Hot Encoding для того, чтобы модели могли на них обучаться. 

Была выделена тестовая выборка: 25% от объема данных. 

Обучены три модели: логистическая регрессия, случайный лес и CatBoost. 
При обучении был использован метод автоматического подбора гиперпараметров GridSearchCV. 
Наилучшие результаты метрики ROC AUC на кросс-валидации показала модель CatBoost со следующими гиперпараметрами: `{'depth': 4, 'iterations': 1000, 'learning_rate': 0.04}`. 

**Значение ROC AUC на кросс-валидации аналогично показателями, полученным при проверке модели CatBoost на тестовой выборке: 0.92** 
